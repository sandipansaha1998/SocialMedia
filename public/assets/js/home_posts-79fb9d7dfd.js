let create_post=function(){let e=$("#new-post-form");e.submit((function(t){t.preventDefault(),$.ajax({type:"post",url:"/post/create",data:e.serialize(),success:function(t){let n=t.data.post,o=t.data.username,a=newPostDom(n,o);$("#posts-list-container>ul").prepend(a),$("textarea",e).val(""),deletePost($(" .delete-post-button",a)),flash(t.data.flash.type,t.data.flash.message)},error:function(e){console.log(e.responseText)}})}))}(),newPostDom=function(e,t){return $(`<li id="post-${e._id}" style="border: 1px solid black; margin:10px">\n    \n        <a class="delete-post-button" href="/post/destroy/${e._id}" method="POST">\n            X\n        </a>\n        \n            ${e.content}\n                <span style="color:green">\n                    ${t}\n                  </span>\n                <div id="comments-container">\n                    <ul style="color:red">\n                        \n\n                    </ul>\n                </div>\n                <form action="/comment/create" method="POST" id="${e._id}" class="create-new-comment">\n                    <input type="text" name="content" placeholder="Write a comment..." form="${e._id}">\n                    <input type="hidden" name="postID" value="${e._id}" form="${e._id}">\n                    <input type="submit" form="${e._id}" hidden />\n                </form>\n            </li>`)},deletePost=function(e){$(e).click((function(t){t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){console.log(`post-${e.data.post_id}`),$(`#post-${e.data.post_id}`).remove(),flash(e.data.flash.type,e.data.flash.message)},error:function(e){console.log(e.responseText)}})}))};for(let e of $(".delete-post-button"))deletePost(e);let flash=function(e,t){new Noty({theme:"relax",text:t,type:e,layout:"topRight",timeout:1500}).show()},createComment=function(e){$(e).submit((function(t){t.preventDefault(),$.ajax({type:"post",url:"/comment/create",data:$(e).serialize(),success:function(t){let n=newCommentDOM(t.data.comment,t.data.username);$(`#post-${t.data.postID} #comments-container ul`).prepend(n),addDeleteCommentListner($(" .delete-comment-button",n)),$("input[type=text]",e).val("")},error:function(e){console.log("Error:",e)}})}))},newCommentDOM=function(e,t){return $(`<li id="comment-${e._id}">\n              ${e.content}  ${t}\n              <a class = "delete-comment-button" href="/comment/destroy/${e._id}">Delete</a><br>\n</li>`)},addDeleteCommentListner=function(e){$(e).click((t=>{t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){console.log($(`#comment-${e.data.commentID}`)),$(`#comment-${e.data.commentID}`).remove()},error:function(e){console.log(e.responseText)}})}))};for(let e of $(".delete-comment-button"))addDeleteCommentListner(e);for(let e of $(".create-new-comment"))createComment($(e));